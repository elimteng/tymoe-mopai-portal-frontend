# âœ… é…æ–¹æ‰“å°ä»£ç ç³»ç»Ÿ - å®Œæˆ

## ğŸ‰ å®ç°å®Œæˆï¼

é…æ–¹æ‰“å°ä»£ç ç³»ç»Ÿå·²ç»å®Œå…¨å®ç°å¹¶é›†æˆåˆ°é¡¹ç›®ä¸­ã€‚

---

## ğŸ“¦ å·²å®Œæˆçš„æ–‡ä»¶

### 1. æ ¸å¿ƒåŠŸèƒ½
- âœ… `src/services/recipe/types.ts` - ç±»å‹å®šä¹‰æ›´æ–°
- âœ… `src/utils/printCodeGenerator.ts` - æ‰“å°ä»£ç ç”Ÿæˆå™¨ï¼ˆæ–°å»ºï¼‰
- âœ… `src/pages/RecipeGuide/RecipeStepEditor.tsx` - æ­¥éª¤ç¼–è¾‘å™¨ç»„ä»¶ï¼ˆæ–°å»ºï¼‰
- âœ… `src/pages/RecipeGuide/RecipeFormWithSteps.tsx` - é…æ–¹è¡¨å•ç»„ä»¶ï¼ˆæ–°å»ºï¼‰

### 2. é›†æˆ
- âœ… `src/pages/RecipeGuide/RecipeByModifierManager.tsx` - å·²é›†æˆæ–°è¡¨å•

### 3. å›½é™…åŒ–
- âœ… `src/i18n/locales/zh-CN.ts` - ç®€ä½“ä¸­æ–‡ç¿»è¯‘
- âœ… `src/i18n/locales/en.ts` - è‹±æ–‡ç¿»è¯‘
- âœ… `src/i18n/locales/zh-TW.ts` - ç¹ä½“ä¸­æ–‡ç¿»è¯‘

### 4. æ–‡æ¡£
- âœ… `RECIPE_PRINT_CODE_GUIDE.md` - å®Œæ•´ä½¿ç”¨æŒ‡å—
- âœ… `RECIPE_PRINT_CODE_IMPLEMENTATION.md` - å®ç°æ€»ç»“
- âœ… `RECIPE_PRINT_CODE_COMPLETE.md` - æœ¬æ–‡ä»¶

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°

1. **æ­¥éª¤ç¼–è¾‘å™¨**
   - æ·»åŠ /åˆ é™¤/æ’åºæ­¥éª¤
   - é€‰æ‹©æ­¥éª¤ç±»å‹
   - è¾“å…¥instructionï¼ˆæ•°é‡/æ“ä½œ/å¿«æ·é”®ï¼‰
   - å®æ—¶ä»£ç é¢„è§ˆ

2. **è®¾å¤‡æ­¥éª¤åŒ…å«åŠŸèƒ½**
   - è®¾å¤‡æ­¥éª¤å¯ä»¥åŒ…å«å…¶ä»–æ­¥éª¤
   - ä½¿ç”¨Checkboxé€‰æ‹©è¦åŒ…å«çš„æ­¥éª¤
   - è¢«åŒ…å«çš„æ­¥éª¤æ˜¾ç¤ºç°è‰²æ ‡è®°
   - è‡ªåŠ¨ä½¿ç”¨å®¹å™¨å‰åç¼€åŒ…è£¹

3. **æ‰“å°ä»£ç ç”Ÿæˆ**
   - å•ä¸ªæ­¥éª¤: `code + instruction = mk200`
   - è®¾å¤‡æ­¥éª¤: `[åŒ…å«çš„æ­¥éª¤]instruction = [mk200]2`
   - å®Œæ•´é…æ–¹: åªè¿æ¥æœªè¢«åŒ…å«çš„æ­¥éª¤

4. **å®æ—¶é¢„è§ˆ**
   - æ¯ä¸ªæ­¥éª¤æ˜¾ç¤ºç”Ÿæˆçš„ä»£ç 
   - é¡¶éƒ¨æ˜¾ç¤ºå®Œæ•´recipeæ‰“å°ä»£ç 
   - è¢«åŒ…å«æ­¥éª¤æ˜¾ç¤º"å·²è¢«åŒ…å«"æ ‡è®°

5. **UI/UX**
   - æ­¥éª¤å¡ç‰‡æ¸…æ™°å±•ç¤º
   - ä»£ç Tagå®æ—¶æ›´æ–°
   - æ‹–æ‹½æ’åºæ”¯æŒ
   - ä»£ç è§„åˆ™è¯´æ˜
   - å®Œæ•´çš„é”™è¯¯å¤„ç†

6. **å›½é™…åŒ–**
   - æ”¯æŒä¸­æ–‡/è‹±æ–‡/ç¹ä½“ä¸­æ–‡
   - æ‰€æœ‰UIæ–‡æœ¬å¯ç¿»è¯‘

---

## ğŸ”„ ä½¿ç”¨æµç¨‹

### ç”¨æˆ·æ“ä½œ

1. **è¿›å…¥åˆ¶ä½œæŒ‡å¼•é¡µé¢**
   - é€‰æ‹©å•†å“ï¼ˆå¦‚ï¼šBlack Milk Teaï¼‰
   - æŸ¥çœ‹ä¿®é¥°ç¬¦ç»„åˆï¼ˆå¦‚ï¼šå¤§æ¯å†°ï¼‰

2. **ç‚¹å‡»"åˆ›å»ºé…æ–¹"**
   - è¾“å…¥å•†å“æ‰“å°ä»£ç ï¼ˆå¦‚ï¼šLICEï¼‰
   - è¾“å…¥æ˜¾ç¤ºä»£ç ï¼ˆå¦‚ï¼šL-ICEï¼‰

3. **æ·»åŠ åˆ¶ä½œæ­¥éª¤**
   ```
   æ­¥éª¤1: é€‰æ‹© Milk (mk) + è¾“å…¥ "200"
   â†’ ç”Ÿæˆ: mk200
   
   æ­¥éª¤2: é€‰æ‹© Tea (tea) + è¾“å…¥ "100"  
   â†’ ç”Ÿæˆ: tea100
   
   æ­¥éª¤3: é€‰æ‹© Blender ([])
   - è¾“å…¥: "2"
   - å‹¾é€‰: â˜‘ æ­¥éª¤1  â˜‘ æ­¥éª¤2
   â†’ ç”Ÿæˆ: [mk200tea100]2
   
   æ­¥éª¤4: é€‰æ‹© Sugar (sg) + è¾“å…¥ "50"
   â†’ ç”Ÿæˆ: sg50
   ```

4. **æŸ¥çœ‹æœ€ç»ˆä»£ç **
   ```
   Recipeæ‰“å°ä»£ç : [mk200tea100]2sg50
   ```

5. **æäº¤ä¿å­˜**
   - å‰ç«¯å‘é€æ•°æ®åˆ°åç«¯
   - åç«¯ä¿å­˜åˆ°æ•°æ®åº“

---

## ğŸ“Š æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
  â†“
RecipeStepEditor (æ”¶é›†æ­¥éª¤æ•°æ®)
  â†“
printCodeGenerator (ç”Ÿæˆæ‰“å°ä»£ç )
  â†“
å®æ—¶UIé¢„è§ˆ
  â†“
æäº¤åˆ°åç«¯
  â†“
æ•°æ®åº“ä¿å­˜
```

---

## ğŸ¨ UIæˆªå›¾è¯´æ˜

### é¡¶éƒ¨é¢„è§ˆåŒºåŸŸ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â„¹ï¸ Recipeæ‰“å°ä»£ç                        â”‚
â”‚                                        â”‚
â”‚ [mk200tea100]2sg50                     â”‚
â”‚                                        â”‚
â”‚ æ­¤ä»£ç å°†ä¿å­˜åˆ°æ•°æ®åº“ï¼Œç”¨äºè®¢å•æ‰“å°      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ™®é€šæ­¥éª¤å¡ç‰‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 1   mk200         [â†‘][â†“][Ã—]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ­¥éª¤ç±»å‹: [Milk (mk)            â–¼]    â”‚
â”‚ Instruction: [200_____________]        â”‚
â”‚                                        â”‚
â”‚ âœ… ä»£ç : mk + 200 = mk200              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾å¤‡æ­¥éª¤å¡ç‰‡ï¼ˆåŒ…å«å…¶ä»–æ­¥éª¤ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ 3  ğŸ”§è®¾å¤‡  [mk200tea100]2  [â†‘][â†“][Ã—]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ­¥éª¤ç±»å‹: [Blender ([])         â–¼]    â”‚
â”‚ Instruction: [2________________]       â”‚
â”‚                                        â”‚
â”‚ åŒ…å«çš„æ­¥éª¤:                             â”‚
â”‚ â˜‘ æ­¥éª¤1: Milk mk200                   â”‚
â”‚ â˜‘ æ­¥éª¤2: Tea tea100                   â”‚
â”‚                                        â”‚
â”‚ âœ… ä»£ç : [mk200tea100]2                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¢«åŒ…å«çš„æ­¥éª¤ï¼ˆç°è‰²+è™šçº¿è¾¹æ¡†ï¼‰
```
â”Œ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”
â”‚ æ­¥éª¤ 1  å·²è¢«åŒ…å«  mk200   [â†‘][â†“][Ã—]  â”‚
â”œ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”¤
â”‚ æ­¥éª¤ç±»å‹: Milk (mk)                   â”‚
â”‚ Instruction: 200                       â”‚
â”‚                                        â”‚
â”‚ âœ… ä»£ç : mk + 200 = mk200              â”‚
â”” â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”ˆ â”˜
```

---

## ğŸš€ å¦‚ä½•æµ‹è¯•

### 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
# æˆ–
pnpm dev
```

### 2. è®¿é—®é¡µé¢
```
http://localhost:5173/recipe-guide
```

### 3. æµ‹è¯•æ­¥éª¤
1. é€‰æ‹©ä¸€ä¸ªå•†å“ï¼ˆéœ€è¦å…ˆé…ç½®ä¿®é¥°ç¬¦ï¼‰
2. ç‚¹å‡»æŸä¸ªç»„åˆçš„"åˆ›å»ºé…æ–¹"æŒ‰é’®
3. è¾“å…¥å•†å“æ‰“å°ä»£ç 
4. ç‚¹å‡»"æ·»åŠ æ­¥éª¤"
5. é€‰æ‹©æ­¥éª¤ç±»å‹ï¼ˆMilk, Tea, Blenderç­‰ï¼‰
6. è¾“å…¥instruction
7. å¦‚æœæ˜¯è®¾å¤‡æ­¥éª¤ï¼Œå‹¾é€‰è¦åŒ…å«çš„æ­¥éª¤
8. è§‚å¯Ÿå®æ—¶ç”Ÿæˆçš„æ‰“å°ä»£ç 
9. æäº¤è¡¨å•

### 4. é¢„æœŸç»“æœ
- âœ… æ¯ä¸ªæ­¥éª¤æ˜¾ç¤ºæ­£ç¡®çš„ä»£ç 
- âœ… è®¾å¤‡æ­¥éª¤æ­£ç¡®åŒ…å«å…¶ä»–æ­¥éª¤
- âœ… è¢«åŒ…å«çš„æ­¥éª¤æ˜¾ç¤ºç°è‰²
- âœ… é¡¶éƒ¨æ˜¾ç¤ºå®Œæ•´çš„recipeæ‰“å°ä»£ç 
- âœ… è¡¨å•å¯ä»¥æˆåŠŸæäº¤

---

## âš ï¸ åç«¯éœ€è¦åšçš„å·¥ä½œ

### 1. æ•°æ®åº“æ›´æ–°

```sql
-- recipes è¡¨æ·»åŠ å­—æ®µ
ALTER TABLE recipes 
ADD COLUMN recipe_print_code VARCHAR(500) COMMENT 'å®Œæ•´åˆ¶ä½œæ‰“å°ä»£ç ';

-- recipe_steps è¡¨æ·»åŠ å­—æ®µ
ALTER TABLE recipe_steps
ADD COLUMN instruction VARCHAR(255) COMMENT 'instructionè¾“å…¥',
ADD COLUMN contained_steps JSON COMMENT 'åŒ…å«çš„æ­¥éª¤IDåˆ—è¡¨',
ADD COLUMN generated_print_code VARCHAR(100) COMMENT 'ç”Ÿæˆçš„æ‰“å°ä»£ç ';

-- step_types è¡¨æ·»åŠ å­—æ®µ
ALTER TABLE step_types
ADD COLUMN is_container BOOLEAN DEFAULT false COMMENT 'æ˜¯å¦æ˜¯å®¹å™¨æ­¥éª¤',
ADD COLUMN container_prefix VARCHAR(10) DEFAULT '[' COMMENT 'å®¹å™¨å‰ç¼€',
ADD COLUMN container_suffix VARCHAR(10) DEFAULT ']' COMMENT 'å®¹å™¨åç¼€';
```

### 2. API æ›´æ–°

#### æ¥å—æ–°çš„è¯·æ±‚æ ¼å¼
```json
POST /recipes
{
  "printCode": "LICE",
  "steps": [
    {
      "stepTypeId": "milk-id",
      "instruction": "200",
      "displayOrder": 1,
      "containedSteps": []
    },
    {
      "stepTypeId": "blender-id",
      "instruction": "2",
      "displayOrder": 2,
      "containedSteps": [0]  // åŒ…å«ç¬¬0ä¸ªæ­¥éª¤
    }
  ]
}
```

#### ç”Ÿæˆå¹¶è¿”å› recipe_print_code
```json
{
  "id": "recipe-001",
  "printCode": "LICE",
  "recipePrintCode": "[mk200]2",  // æ–°å¢å­—æ®µ
  "steps": [...]
}
```

### 3. åç«¯æ‰“å°ä»£ç ç”Ÿæˆé€»è¾‘

å‚è€ƒå‰ç«¯çš„ `printCodeGenerator.ts`ï¼Œæˆ–ç”¨Python/Javaé‡æ–°å®ç°ï¼š

```python
def generate_recipe_print_code(steps, step_types):
    # 1. æ ‡è®°è¢«åŒ…å«çš„æ­¥éª¤
    contained_indices = set()
    for step in steps:
        if step.contained_steps:
            contained_indices.update(step.contained_steps)
    
    # 2. ç”Ÿæˆæ‰“å°ä»£ç 
    codes = []
    for i, step in enumerate(steps):
        if i in contained_indices:
            continue  # è·³è¿‡è¢«åŒ…å«çš„æ­¥éª¤
        
        step_type = step_types[step.step_type_id]
        code = step_type.code + (step.instruction or '')
        
        # å¦‚æœæ˜¯å®¹å™¨æ­¥éª¤
        if step_type.is_container and step.contained_steps:
            prefix = step_type.container_prefix or '['
            suffix = step_type.container_suffix or ']'
            
            # ç”Ÿæˆè¢«åŒ…å«æ­¥éª¤çš„ä»£ç 
            contained_codes = ''.join([
                step_types[steps[j].step_type_id].code + 
                (steps[j].instruction or '')
                for j in step.contained_steps
            ])
            
            code = f"{prefix}{contained_codes}{suffix}{step.instruction or ''}"
        
        codes.append(code)
    
    return ''.join(codes)
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´ä½¿ç”¨æŒ‡å—](./RECIPE_PRINT_CODE_GUIDE.md)
- [å®ç°æ€»ç»“](./RECIPE_PRINT_CODE_IMPLEMENTATION.md)
- [APIæ–‡æ¡£](./src/pages/MenuCenter/ModifierGroupApi/api.md)

---

## âœ… æ£€æŸ¥æ¸…å•

### å‰ç«¯ï¼ˆå·²å®Œæˆï¼‰
- [x] ç±»å‹å®šä¹‰æ›´æ–°
- [x] æ‰“å°ä»£ç ç”Ÿæˆå™¨
- [x] æ­¥éª¤ç¼–è¾‘å™¨ç»„ä»¶
- [x] é…æ–¹è¡¨å•ç»„ä»¶
- [x] é›†æˆåˆ°é…æ–¹ç®¡ç†é¡µé¢
- [x] i18nç¿»è¯‘ï¼ˆä¸­/è‹±/ç¹ï¼‰
- [x] å®æ—¶é¢„è§ˆ
- [x] UI/UXå®Œå–„
- [x] é”™è¯¯å¤„ç†
- [x] æ–‡æ¡£å®Œæ•´

### åç«¯ï¼ˆå¾…å®ç°ï¼‰
- [ ] æ•°æ®åº“schemaæ›´æ–°
- [ ] APIæ¥å—æ–°å­—æ®µ
- [ ] ç”ŸæˆrecipePrintCodeé€»è¾‘
- [ ] è¿”å›æ–°å­—æ®µ
- [ ] æµ‹è¯•æ‰“å°ä»£ç ç”Ÿæˆ

---

## ğŸŠ æ€»ç»“

æ–°çš„é…æ–¹æ‰“å°ä»£ç ç³»ç»Ÿå·²ç»å®Œå…¨å®ç°å¹¶é›†æˆï¼

**ä¸»è¦ç‰¹æ€§**:
- âœ… æ­¥éª¤ + instruction = æ‰“å°ä»£ç 
- âœ… è®¾å¤‡æ­¥éª¤åŒ…å«å…¶ä»–æ­¥éª¤
- âœ… å®æ—¶é¢„è§ˆæ‰“å°ä»£ç 
- âœ… è¢«åŒ…å«æ­¥éª¤æ ‡è®°
- âœ… å®Œæ•´çš„UI/UX
- âœ… å¤šè¯­è¨€æ”¯æŒ

**ä¸‹ä¸€æ­¥**: ç­‰å¾…åç«¯æ›´æ–°æ•°æ®åº“å’ŒAPIåå³å¯å®Œæ•´ä½¿ç”¨ï¼

---

**å®ç°æ—¥æœŸ**: 2025-10-31  
**çŠ¶æ€**: âœ… å‰ç«¯å®Œæˆï¼Œç­‰å¾…åç«¯é›†æˆ  
**ç‰ˆæœ¬**: 1.0.0














