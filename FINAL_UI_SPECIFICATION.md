# 配方步骤UI最终规范

## 📋 字段显示规则

### 普通步骤（材料/操作）

显示字段：
1. ✅ **步骤类型** (必填) - 下拉选择
2. ✅ **数量** - 数字输入
3. ✅ **耗时** - 数字输入（秒）

不显示字段：
- ❌ 原料信息（ingredients）- 后台字段，不显示
- ❌ 操作说明（operation）- 仅设备步骤显示

### 设备步骤

显示字段：
1. ✅ **步骤类型** (必填) - 下拉选择
2. ✅ **材料引用** - 多选下拉框
3. ✅ **操作说明** - 文本域
4. ✅ **耗时** - 数字输入（秒）

不显示字段：
- ❌ 数量（amount）- 设备步骤不需要
- ❌ 原料信息（ingredients）- 自动生成，不显示

---

## 🎨 UI布局

### 普通步骤UI

```
┌─────────────────────────────────────────┐
│ 步骤 1                           [↑][↓][×]│
├─────────────────────────────────────────┤
│ * 步骤类型                              │
│ ┌─────────────────────────────────────┐ │
│ │ [M] 牛奶 (材料)                  ▼  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 数量                                    │
│ ┌─────────────────────────────────────┐ │
│ │ 200                                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 耗时                                    │
│ ┌──────────┐                            │
│ │ 30      │ 秒                         │
│ └──────────┘                            │
│                                         │
│ 💡 打印代码由后端自动生成               │
└─────────────────────────────────────────┘
```

### 设备步骤UI

```
┌─────────────────────────────────────────┐
│ 步骤 2                           [↑][↓][×]│
├─────────────────────────────────────────┤
│ * 步骤类型                              │
│ ┌─────────────────────────────────────┐ │
│ │ [] 搅拌机 (设备)                 ▼  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 🔧 设备步骤 - 选择要处理的材料      │ │
│ │                                     │ │
│ │ ┌─────────────────────────────────┐ │ │
│ │ │ ☑ 步骤1: 牛奶 (200)             │ │ │
│ │ │ ☑ 步骤2: 糖 (30)                │ │ │
│ │ └─────────────────────────────────┘ │ │
│ │                                     │ │
│ │ 💡 选择的材料会用于生成打印代码     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 操作说明                                │
│ ┌─────────────────────────────────────┐ │
│ │ 搅拌均匀                            │ │
│ │                                     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 耗时                                    │
│ ┌──────────┐                            │
│ │ 30      │ 秒                         │
│ └──────────┘                            │
│                                         │
│ 💡 打印代码由后端自动生成               │
└─────────────────────────────────────────┘
```

---

## 🔄 数据流程

### 普通步骤

```
用户输入：
- 步骤类型: 牛奶
- 数量: 200
- 耗时: 30

发送到后端：
{
  "stepTypeId": "milk-uuid",
  "amount": 200,
  "duration": 30,
  "sortOrder": 0,
  "stepNumber": 1
}

后端返回：
{
  "stepNumber": 1,
  "stepTypeId": "milk-uuid",
  "amount": 200,
  "duration": 30,
  "printCode": "M200"  // ✅ 自动生成
}
```

### 设备步骤

```
用户输入：
- 步骤类型: 搅拌机
- 材料引用: [步骤1: 牛奶 200, 步骤2: 糖 30]
- 操作说明: 搅拌均匀
- 耗时: 30

自动生成（不显示）：
- ingredients: "步骤1: 牛奶 200, 步骤2: 糖 30"

发送到后端：
{
  "stepTypeId": "blender-uuid",
  "ingredients": "步骤1: 牛奶 200, 步骤2: 糖 30",
  "operation": "搅拌均匀",
  "duration": 30,
  "sortOrder": 1,
  "stepNumber": 2
}

后端返回：
{
  "stepNumber": 2,
  "stepTypeId": "blender-uuid",
  "ingredients": "步骤1: 牛奶 200, 步骤2: 糖 30",
  "operation": "搅拌均匀",
  "duration": 30,
  "printCode": "[M200+S30]"  // ✅ 自动生成
}
```

---

## 💡 设计理念

### 1. 简洁性
- 只显示用户需要输入的字段
- 隐藏后台自动生成的字段
- 减少视觉干扰

### 2. 直观性
- 设备步骤可以直接选择材料
- 不需要记住步骤编号
- 自动生成后台需要的数据

### 3. 灵活性
- 材料引用自动生成ingredients
- 但后端仍可根据需要使用该字段
- 前端不显示，保持UI简洁

### 4. 一致性
- 所有步骤都有耗时字段
- 操作说明只在需要时显示（设备步骤）
- 统一的提示信息样式

---

## 📊 字段对照表

| 字段 | 普通步骤 | 设备步骤 | 说明 |
|------|---------|---------|------|
| stepTypeId | ✅ 显示 | ✅ 显示 | 必填，下拉选择 |
| amount | ✅ 显示 | ❌ 隐藏 | 数字输入 |
| ingredients | ❌ 隐藏 | ❌ 隐藏 | 自动生成，不显示 |
| operation | ❌ 隐藏 | ✅ 显示 | 文本域 |
| duration | ✅ 显示 | ✅ 显示 | 数字输入 |
| printCode | ❌ 隐藏 | ❌ 隐藏 | 后端生成，不显示 |
| _selectedSteps | ❌ 隐藏 | ✅ 显示 | 临时字段，UI用 |

---

## ✅ 优势总结

1. **用户体验**
   - 界面简洁，不显示不必要的字段
   - 设备步骤可以直观选择材料
   - 自动生成后台需要的数据

2. **数据准确**
   - 自动生成ingredients字符串
   - 避免手动输入错误
   - 符合后端API要求

3. **维护性**
   - 前端UI和后端数据分离
   - 临时字段不发送到后端
   - 易于理解和维护

---

**状态**: ✅ 最终规范确定  
**实现**: ✅ 已完成  
**测试**: 待测试
